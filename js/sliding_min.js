/*
 * Sliding Website Plugin 
 * Programmer: Fabio Ferrante
 * CodeCanyon: http://codecanyon.net/user/kernelstudio/portfolio
 *
 * If this script you like, please put a comment on codecanyon.
 *
 * Includes jQuery Easing v1.3
 * http://gsgd.co.uk/sandbox/jquery/easing/
 * Copyright (c) 2008 George McGinley Smith
 * jQuery Easing released under the BSD License.	
 *
 * Includes jQuery Address v1.4
 * http://www.asual.com/jquery/address/
 * Copyright (c) 2004-2010 Asual DZZD
 * jQuery Easing released under both MIT and GPL licenses.	
 *
*/
(function(a){function g(b){count=0;d.each(function(){if(a(this).find("a").attr("rel")===b){position=count}count++});return position}function h(){$newpage.load(settings.url,function(){if(_thisSlideCallback!==""){settings.callbacks[_thisSlideCallback]()}e.css("min-height",$newpage.css("height"));$newpage.css("min-height",$newpage.css("height"));_toLoad=false})}function j(a){path=a.path;if(path.charAt(0)==="/"){path=path.substr(1)}if(path.charAt(path.length-1)==="/"){path=path.substr(0,path.length-1)}settings.toLoad=path;if(!f&&settings.toLoad!==""){n()}}function k(b){if(b.data("transition")!=null){if(b.data("transition").slideScroll!=null&&b.data("transition").slideScroll!==""){_thisSlideScroll=b.data("transition").slideScroll}if(b.data("transition").easing!=null&&b.data("transition").easing!==""){_thisSlideEasing=b.data("transition").easing}if(b.data("transition").callback!=null&&b.data("transition").callback!==""){_thisSlideCallback=b.data("transition").callback;_thisSlideCallback=function(){a(this).data("transition").callback}}}settings.toLoad=b.attr("rel");window.location="#/"+settings.toLoad;if(f){n()}}function l(){a("body").append('<a class="next">Next</a>');a("body").append('<a class="prev">Prev</a>');a(".next").css("top",Math.round((b.height()-a(".next").height())/2));a(".prev").css("top",Math.round((b.height()-a(".prev").height())/2));a(".next , .prev").click(function(){k(a(this));return false})}function m(b){var c=a("ul").index(b.parents().eq(1));if(c>0){var d=1;for(i=0;i<c;i++){d=d+i+1;b.parents().eq(d).find("a:first").addClass("current")}if(settings.navigation.nestedPagesFlows){var e=b.parent();e.parent().parent().find("ul").css({left:0}).stop(false,false).fadeTo("fast",1).delay(300).fadeTo("fast",0,function(){e.parent().parent().find("ul").removeAttr("style")});if(e.is("li:first-child")&&e.is("li:not(:last-child)")){_prevPage=b.parents().eq(2).find("a");_nextPage=e.next().find("a")}else if(b.parent().is("li:last-child")&&b.parent().is("li:not(:first-child)")){_prevPage=e.prev().find("a");_nextPage=b.parents().eq(2).next().find("a")}else if(e.is("li:first-child")&&e.is("li:last-child")){_prevPage=b.parents().eq(2).find("a");_nextPage=b.parents().eq(2).next().find("a")}else{_prevPage=e.prev().find("a");_nextPage=e.next().find("a")}}}else{var f=b.parent().find("ul").length;if(f>0&&settings.navigation.nestedPagesFlows){_nextPage=b.parent().children().find("a");_prevPage=b.parent().prev().find("a")}else{_nextPage=b.parent().next().find("a");_prevPage=b.parent().prev().find("a")}}if(_nextPage.attr("rel")==null){_nextPage=b.parents().eq(1).children(":first").find("a")}if(_prevPage.attr("rel")==null){_prevPage=b.parents().eq(1).children(":last").find("a")}a(".next").attr({rel:_nextPage.attr("rel"),href:_nextPage.attr("href"),title:_nextPage.attr("title")});if(_nextPage.attr("data-transition")!=null){a(".next").attr("data-transition",_nextPage.attr("data-transition"))}else{a(".next").removeAttr("data-transition")}a(".prev").attr({rel:_prevPage.attr("rel"),href:_prevPage.attr("href"),title:_prevPage.attr("title")});if(_prevPage.attr("data-transition")!=null){a(".prev").attr("data-transition",_prevPage.attr("data-transition"))}else{a(".prev").removeAttr("data-transition")}if(b.data("transition")!=null){if(b.data("transition").slideScroll!=null&&b.data("transition").slideScroll!==""){_thisSlideScroll=b.data("transition").slideScroll}if(b.data("transition").easing!=null&&b.data("transition").easing!==""){_thisSlideEasing=b.data("transition").easing}if(b.data("transition").callback!=null&&b.data("transition").callback!==""){_thisSlideCallback=b.data("transition").callback}}}function n(){if(!settings.animate&&settings.toLoad!==""&&settings.actual!==""){_tempSlideEasing="";_thisSlideEasing="";_tempSlideScroll="";_thisSlideScroll="";_thisSlideCallback="";_isAnimating=settings.toLoad;var f=settings.actual;if(settings.toLoad===""){window.location="#/"+d.first().find("a").attr("rel");settings.toLoad=d.first().find("a").attr("rel")}d.find("a").removeClass("current").each(function(){if(a(this).attr("rel")===settings.toLoad){a(this).toggleClass("current");m(a(this));return false}});if(f!==settings.toLoad){$oldpage=a("#"+f);$newpage=a("#"+settings.toLoad);settings.animate=true;csstop=-_scroll+settings.top;$oldpage.css({position:"fixed",top:csstop});e.css("min-height",b.height()+10-settings.top);a.data(document.body,"_scroll",_scroll);b.scrollTop(0);settings.actual=settings.toLoad;d.each(function(){if(a(this).find("a").attr("rel")===settings.toLoad){settings.url=a(this).find("a").attr("href");settings.title=a(this).find("a").attr("title");if(settings.title!==""){c.title=c.title.substring(0,c.title.lastIndexOf(" |"));c.title=c.title+" | "+settings.title}}});if($newpage.is("*")){if($newpage.hasClass("pageContainer")===false){$newpage.addClass("pageContainer")}$newpage.show();e.css("min-height",$newpage.css("height"))}else{e.append('<div class="pageContainer" id="'+settings.toLoad+'"/>');$newpage=a("#"+settings.toLoad);$newpage.css({"min-height":b.height()+10-settings.top});$newpage.hide();e.css("min-height",b.height()+10-settings.top);$newpage.append('<div class="loading"/>');_toLoad=true}if(_thisSlideScroll!==""){settings.slideScroll=_thisSlideScroll}if(_thisSlideEasing!==""){settings.easing=_thisSlideEasing}switch(settings.easing){case"fade":$newpage.css({left:0});if(_thisSlideCallback!==""&&!_toLoad){settings.callbacks[_thisSlideCallback]()}$newpage.hide();$oldpage.fadeOut(settings.speed,function(){$oldpage.css({position:"absolute",top:0})});$newpage.fadeIn(settings.speed,function(){if(_thisSlideEasing!==""){settings.easing=_tempSlideEasing;_tempSlideEasing="";_thisSlideEasing=""}if(_thisSlideScroll!==""){settings.slideScroll=_tempSlideScroll;_tempSlideScroll="";_thisSlideScroll=""}if(_toLoad){h()}_scroll=0;settings.animate=false;$oldpage.hide();if(_isAnimating!=settings.toLoad){n()}});break;default:if(settings.slideScroll==="vertical"){a.data($newpage,"z-index",$newpage.css("z-index"));$oldpage.after('<div class="outerold" />');$outerold=a(".outerold");$outerold.css({width:100+"%","min-height":b.height()+10,overflow:"hidden",position:"absolute",top:0,"z-index":parseInt($oldpage.css("z-index"))+1});$oldpage.css({position:"absolute",top:-a.data(document.body,"_scroll")});$outerold.wrapInner($oldpage);if(g(f)>g(settings.toLoad)){$newpage.css({left:0,top:b.height()-settings.top});moveActualPage=0-b.height()+settings.top}else{$newpage.css({left:0,top:0-b.height()+settings.top});moveActualPage=b.height()-settings.top}$newpage.show();if(_thisSlideCallback!==""&&!_toLoad){settings.callbacks[_thisSlideCallback]()}a("html, body").animate({scrollTop:0},10);$outerold.animate({top:moveActualPage},settings.speed,settings.easing,function(){$oldpage.unwrap();$oldpage.css({position:"absolute",top:0})});$newpage.animate({top:0},settings.speed,settings.easing,function(){if(_thisSlideEasing!==""){settings.easing=_tempSlideEasing;_tempSlideEasing="";_thisSlideEasing=""}if(_thisSlideScroll!==""){settings.slideScroll=_tempSlideScroll;_tempSlideScroll="";_thisSlideScroll=""}if(_toLoad){h()}_scroll=0;settings.animate=false;$oldpage.hide();if(_isAnimating!=settings.toLoad){n()}})}else{if(g(f)<g(settings.toLoad)){$newpage.css({left:b.width()});moveActualPage=0-b.width()}else{$newpage.css({left:0-b.width()});moveActualPage=b.width()}$newpage.show();if(_thisSlideCallback!==""&&!_toLoad){settings.callbacks[_thisSlideCallback]()}a("html, body").animate({scrollTop:0},10);$oldpage.animate({left:moveActualPage},settings.speed,settings.easing,function(){$oldpage.css({position:"absolute",top:0})});$newpage.animate({left:0},settings.speed,settings.easing,function(){if(_thisSlideEasing!==""){settings.easing=_tempSlideEasing;_tempSlideEasing="";_thisSlideEasing=""}if(_thisSlideScroll!==""){settings.slideScroll=_tempSlideScroll;_tempSlideScroll="";_thisSlideScroll=""}if(_toLoad){h()}_scroll=0;settings.animate=false;$oldpage.hide();if(_isAnimating!=settings.toLoad){n()}})}}}}}function o(){if(e.is("*")===false){a("body").wrapInner('<div id="contentSlide" />');e=a("#contentSlide")}e.css("top",settings.top);if(settings.navigation.show){l()}_tempSlideScroll=settings.slideScroll;_tempSlideEasing=settings.easing;if(d.is("*")){settings.actual=window.location.hash.replace("#/","");if(settings.actual===""){d.each(function(){if(a(this).hasClass("startPage")){settings.actual=a(this).find("a").attr("rel");window.location="#/"+settings.actual;_findStart=true}});if(!_findStart){window.location="#/"+d.first().find("a").attr("rel");settings.actual=d.first().find("a").attr("rel")}}d.each(function(){a("#"+a(this).find("a").attr("rel")).hide();if(a(this).find("a").attr("rel")===settings.actual){a(this).find("a").addClass("current");m(a(this).find("a"));settings.url=a(this).find("a").attr("href");settings.title=a(this).find("a").attr("title");if(settings.title!==""){c.title=c.title+" | "+settings.title}if(a(this).find("a").data("transition")!=null){if(a(this).find("a").data("transition").callback!=null&&a(this).find("a").data("transition").callback!==""){_thisSlideCallback=a(this).find("a").data("transition").callback}}}});$firstpage=a("#"+settings.actual);if($firstpage.is("*")){if($firstpage.hasClass("pageContainer")===false){$firstpage.addClass("pageContainer")}$firstpage.show();if(_thisSlideCallback!==""){settings.callbacks[_thisSlideCallback]()}e.css("min-height",a("#"+settings.actual).css("height"))}else{e.css("min-height",b.height()+10-settings.top);e.append('<div class="pageContainer" id="'+settings.actual+'"/>');$firstpage=a("#"+settings.actual);$firstpage.append('<div class="loading"/>');$firstpage.load(settings.url,function(){e.css("min-height",a("#"+settings.actual).css("height"));if(_thisSlideCallback!==""){settings.callbacks[_thisSlideCallback]()}})}}}var b,c,d,e;b=a(window);c=document;e=a("#contentSlide");_findStart=false;_scroll=0;_toLoad=false;_thisSlideScroll="";_thisSlideEasing="";_thisSlideCallback="";a("html, body").scrollTop(_scroll);var f=window.location!=window.parent.location?true:false;b.scroll(function(){_scroll=b.scrollTop()});b.resize(function(){if(settings.navigation){a(".next").css("top",Math.round((b.height()-a(".next").height())/2));a(".prev").css("top",Math.round((b.height()-a(".prev").height())/2))}if(parseInt(e.css("min-height"))<b.height()){e.css("min-height",b.height())}});a.fn.slidingPage=function(b){d=a(this);defaults={actual:"",toLoad:"",url:"",title:"",animate:false,speed:1500,easing:"easeInOutQuint",slideScroll:"horizontal",top:0,navigation:{show:true,nestedPagesFlows:true},callbacks:{}};settings=a.extend({},defaults,b);if(!f){a.address.init(o).change(j)}else{o()}d.find("a").add(".revolver").click(function(b){b.stopPropagation();k(a(this));return false})}})(jQuery)